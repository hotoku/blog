---
layout: post
title: ローゼンバウム 因果推論とは何か 読書メモ
date: 2025-07-25 17:12:30 +0900
categories: blog
tags: statistics
---

掲題の本を買ったので、読書メモを残しておく。

## 第一章

最初はイントロダクションなので、やさしい。

病人のKimとJamesがいて、彼らは30日後に死ぬかもしれないとする。
何らかの処置があって、この処置によって、彼らの運命を変えられるのか、そうでもないのか、を判定したい。

以下、1を生存、0を死とする。生存か死かの結果を表す変数を$$r$$と書くことにする。$$r$$に添え字で$$T$$か$$C$$かを付けることで、処置をした場合/しなかった場合の結果を表すことにする。
さらに、$$T, C$$に$$K,J$$の添え字を付けることで、Kim/Jamesの結果を表すことにする。

例：$$r_{T_{K}} = 1$$ Kimは、処置を受けた場合、生存する

今、興味があるのは、処置に効果があるのかどうか？つまり、

- Kimにとっての効果：$$r_{T_{K}} - r_{C_{K}}$$
- Jamesにｔっての効果：$$r_{T_{J}} - r_{C_{J}}$$

である。これらは、直接には観測できない。なぜなら、Kimに処置をしてしまったら、処置しなかった場合どうだったかは分からないじゃろ。さぁ、どうしよう。

何もできないよりはマシじゃろってことで、$$r_{T_{K}} - r_{C_{J}}$$を観測してみるのはどうだろう？つまり、Kimに処置を施しJamesにはしない。で、結果がどうだったかを確認する。
しかし、このような方法はバイアスを生む。

例えば、神様の視点から見た「真の状態」が、

- $$r_{T_{K}} = r_{C_{K}} = 1$$
- $$r_{T_{J}} = r_{C_{J}} = 0$$

だったとする。つまり、この処置には効果がなく、どうしたってKimは生きるし、Jamesは死ぬ。ただ、人間には神様の視点は持てないので、先の方針で実験を行う。

すると、結果は$$r_{T_{K}} = r_{C_{J}} = 1 - 0 = 1$$となって、これを処置の効果なのだ！と思ってしまうと、ほんとは効果がない処置を効果があると誤った判断を下してしまう。

### ランダム化

KimとJamesだけではなくて、たくさんの同じような病人がいるとする。やはり、誰に対しても、この処置には効果がないものとする。もちろん、これは神様の視点で言っていること。人間は神様の視点を持てないので、できる範囲で最善を尽くしたい。どういう実験をしたら、真実（処置には効果がない）に近い結論を得られるだろうか？というのが問題意識。

この場合、たくさんの病人をペアに分けて、各ペアについてコイントスで処置/コントロールを決定する。で、$$r_{T_{K}} - r_{C_{J}}$$のようなそれぞれの結果の差をペアの数だけ集めて、その平均を取る。

するとどうなるか。ペアのパターンは

- 両方とも、どっちにしろ生きるケース
- 両方とも、どっちにしろ死ぬケース
- 片方は生きて、片方は死ぬケース

の3パターンである。1, 2番目の結果からは、真実に等しい、処置の効果なし、とい結果が得られる。3番目のパターンは、1だったり-1だったりするが、ランダムに選んでいるのでたくさんペアがあれば真実の0に近づいていく。
